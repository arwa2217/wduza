"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = exports.i18nTimezones = void 0;

var _react = _interopRequireWildcard(require("react"));

var _reactSelect = _interopRequireDefault(require("react-select"));

var _spacetime = _interopRequireDefault(require("spacetime"));

var _spacetimeInformal = require("spacetime-informal");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _getRequireWildcardCache() { if (typeof WeakMap !== "function") return null; var cache = new WeakMap(); _getRequireWildcardCache = function _getRequireWildcardCache() { return cache; }; return cache; }

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { if (typeof Symbol === "undefined" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var i18nTimezones = {
  'Pacific/Midway': 'Midway Island, Samoa',
  'Pacific/Honolulu': 'Hawaii',
  'America/Juneau': 'Alaska',
  'America/Boise': 'Mountain Time',
  'America/Dawson': 'Dawson, Yukon',
  'America/Chihuahua': 'Chihuahua, La Paz, Mazatlan',
  'America/Phoenix': 'Arizona',
  'America/Chicago': 'Central Time',
  'America/Regina': 'Saskatchewan',
  'America/Mexico_City': 'Guadalajara, Mexico City, Monterrey',
  'America/Belize': 'Central America',
  'America/Detroit': 'Eastern Time',
  'America/Bogota': 'Bogota, Lima, Quito',
  'America/Caracas': 'Caracas, La Paz',
  'America/Santiago': 'Santiago',
  'America/St_Johns': 'Newfoundland and Labrador',
  'America/Sao_Paulo': 'Brasilia',
  'America/Tijuana': 'Tijuana, Pacific Time',
  'America/Argentina/Buenos_Aires': 'Buenos Aires, Georgetown',
  'America/Godthab': 'Greenland',
  'Atlantic/Azores': 'Azores',
  'Atlantic/Cape_Verde': 'Cape Verde Islands',
  GMT: 'Dublin, Edinburgh, Lisbon, London',
  'Africa/Casablanca': 'Casablanca, Monrovia',
  'Atlantic/Canary': 'Canary Islands',
  'Europe/Belgrade': 'Belgrade, Bratislava, Budapest, Ljubljana, Prague',
  'Europe/Sarajevo': 'Sarajevo, Skopje, Warsaw, Zagreb',
  'Europe/Brussels': 'Brussels, Copenhagen, Madrid, Paris',
  'Europe/Amsterdam': 'Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna',
  'Africa/Algiers': 'West Central Africa',
  'Europe/Bucharest': 'Bucharest',
  'Africa/Cairo': 'Cairo',
  'Europe/Helsinki': 'Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius',
  'Europe/Athens': 'Athens, Istanbul, Minsk',
  'Asia/Jerusalem': 'Jerusalem',
  'Africa/Harare': 'Harare, Pretoria',
  'Europe/Moscow': 'Moscow, St. Petersburg, Volgograd',
  'Asia/Kuwait': 'Kuwait, Riyadh',
  'Africa/Nairobi': 'Nairobi',
  'Asia/Baghdad': 'Baghdad',
  'Asia/Tehran': 'Tehran',
  'Asia/Dubai': 'Abu Dhabi, Muscat',
  'Asia/Baku': 'Baku, Tbilisi, Yerevan',
  'Asia/Kabul': 'Kabul',
  'Asia/Yekaterinburg': 'Ekaterinburg',
  'Asia/Karachi': 'Islamabad, Karachi, Tashkent',
  'Asia/Kolkata': 'Chennai, Kolkata, Mumbai, New Delhi',
  'Asia/Kathmandu': 'Kathmandu',
  'Asia/Dhaka': 'Astana, Dhaka',
  'Asia/Colombo': 'Sri Jayawardenepura',
  'Asia/Almaty': 'Almaty, Novosibirsk',
  'Asia/Rangoon': 'Yangon Rangoon',
  'Asia/Bangkok': 'Bangkok, Hanoi, Jakarta',
  'Asia/Krasnoyarsk': 'Krasnoyarsk',
  'Asia/Shanghai': 'Beijing, Chongqing, Hong Kong SAR, Urumqi',
  'Asia/Kuala_Lumpur': 'Kuala Lumpur, Singapore',
  'Asia/Taipei': 'Taipei',
  'Australia/Perth': 'Perth',
  'Asia/Irkutsk': 'Irkutsk, Ulaanbaatar',
  'Asia/Seoul': 'Seoul',
  'Asia/Tokyo': 'Osaka, Sapporo, Tokyo',
  'Asia/Yakutsk': 'Yakutsk',
  'Australia/Darwin': 'Darwin',
  'Australia/Adelaide': 'Adelaide',
  'Australia/Sydney': 'Canberra, Melbourne, Sydney',
  'Australia/Brisbane': 'Brisbane',
  'Australia/Hobart': 'Hobart',
  'Asia/Vladivostok': 'Vladivostok',
  'Pacific/Guam': 'Guam, Port Moresby',
  'Asia/Magadan': 'Magadan, Solomon Islands, New Caledonia',
  'Asia/Kamchatka': 'Kamchatka, Marshall Islands',
  'Pacific/Fiji': 'Fiji Islands',
  'Pacific/Auckland': 'Auckland, Wellington',
  'Pacific/Tongatapu': "Nuku'alofa"
};
exports.i18nTimezones = i18nTimezones;

var TimezoneSelect = function TimezoneSelect(_ref) {
  var value = _ref.value,
      onBlur = _ref.onBlur,
      onChange = _ref.onChange,
      _ref$labelStyle = _ref.labelStyle,
      labelStyle = _ref$labelStyle === void 0 ? 'original' : _ref$labelStyle,
      timezones = _ref.timezones,
      props = _objectWithoutProperties(_ref, ["value", "onBlur", "onChange", "labelStyle", "timezones"]);

  var _useState = (0, _react.useState)({}),
      _useState2 = _slicedToArray(_useState, 2),
      selectedTimezone = _useState2[0],
      setSelectedTimezone = _useState2[1];

  timezones = timezones || i18nTimezones;
  var getOptions = (0, _react.useMemo)(function () {
    var options = [];
    Object.entries(timezones).reduce(function (obj, entry) {
      var a = _spacetime["default"].now()["goto"](entry[0]);

      var tz = a.timezone();
      var tzDisplay = (0, _spacetimeInformal.display)(entry[0]);
      var abbrev = entry[0];
      var altName = entry[0];

      if (tzDisplay && tzDisplay.daylight && tzDisplay.standard) {
        abbrev = a.isDST() ? tzDisplay.daylight.abbrev : tzDisplay.standard.abbrev;
        altName = a.isDST() ? tzDisplay.daylight.name : tzDisplay.standard.name;
      }

      obj.push({
        name: entry[0],
        label: entry[1],
        offset: tz.current.offset,
        abbrev: abbrev,
        altName: altName
      });
      return obj;
    }).sort(function (a, b) {
      return a.offset - b.offset;
    }).map(function (tz) {
      if (tz.offset === undefined) return false;
      var label = '';
      var min = tz.offset * 60;
      var hr = "".concat(min / 60 ^ 0, ":") + (min % 60 === 0 ? '00' : Math.abs(min % 60));
      var prefix = "(GMT".concat(hr.includes('-') ? hr : "+".concat(hr), ") ").concat(tz.label);

      switch (labelStyle) {
        case 'original':
          label = prefix;
          break;

        case 'altName':
          label = "".concat(prefix, " ").concat(!tz.altName.includes('/') ? "(".concat(tz.altName, ")") : '');
          break;

        case 'abbrev':
          label = "".concat(prefix, " \n            ").concat(tz.abbrev.length < 5 ? "(".concat(tz.abbrev, ")") : '');
          break;

        default:
          label = "".concat(prefix);
      }

      options.push({
        value: tz.name,
        label: label,
        abbrev: tz.abbrev,
        altName: tz.altName
      });
    });
    return options;
  }, [labelStyle]);

  var handleChange = function handleChange(tz) {
    setSelectedTimezone(tz);
    onChange && onChange(tz);
  };

  var constructTz = function constructTz(value) {
    var returnTz;

    if (value.value && value.label) {
      returnTz = value;
    } else if (value.value && !value.label) {
      returnTz = getOptions.find(function (tz) {
        return tz.value === value.value;
      });
    } else if (typeof value === 'string' && !selectedTimezone.label) {
      returnTz = getOptions.find(function (tz) {
        return tz.value === value;
      });
    }

    return returnTz;
  };

  return /*#__PURE__*/_react["default"].createElement(_reactSelect["default"], _extends({
    value: constructTz(value),
    onChange: handleChange,
    options: getOptions,
    onBlur: onBlur
  }, props));
};

var _default = TimezoneSelect;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJpMThuVGltZXpvbmVzIiwiR01UIiwiVGltZXpvbmVTZWxlY3QiLCJ2YWx1ZSIsIm9uQmx1ciIsIm9uQ2hhbmdlIiwibGFiZWxTdHlsZSIsInRpbWV6b25lcyIsInByb3BzIiwic2VsZWN0ZWRUaW1lem9uZSIsInNldFNlbGVjdGVkVGltZXpvbmUiLCJnZXRPcHRpb25zIiwib3B0aW9ucyIsIk9iamVjdCIsImVudHJpZXMiLCJyZWR1Y2UiLCJvYmoiLCJlbnRyeSIsImEiLCJzcGFjZXRpbWUiLCJub3ciLCJ0eiIsInRpbWV6b25lIiwidHpEaXNwbGF5IiwiYWJicmV2IiwiYWx0TmFtZSIsImRheWxpZ2h0Iiwic3RhbmRhcmQiLCJpc0RTVCIsIm5hbWUiLCJwdXNoIiwibGFiZWwiLCJvZmZzZXQiLCJjdXJyZW50Iiwic29ydCIsImIiLCJtYXAiLCJ1bmRlZmluZWQiLCJtaW4iLCJociIsIk1hdGgiLCJhYnMiLCJwcmVmaXgiLCJpbmNsdWRlcyIsImxlbmd0aCIsImhhbmRsZUNoYW5nZSIsImNvbnN0cnVjdFR6IiwicmV0dXJuVHoiLCJmaW5kIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFDQTs7QUFDQTs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFTyxJQUFNQSxhQUFhLEdBQUc7QUFDM0Isb0JBQWtCLHNCQURTO0FBRTNCLHNCQUFvQixRQUZPO0FBRzNCLG9CQUFrQixRQUhTO0FBSTNCLG1CQUFpQixlQUpVO0FBSzNCLG9CQUFrQixlQUxTO0FBTTNCLHVCQUFxQiw2QkFOTTtBQU8zQixxQkFBbUIsU0FQUTtBQVEzQixxQkFBbUIsY0FSUTtBQVMzQixvQkFBa0IsY0FUUztBQVUzQix5QkFBdUIscUNBVkk7QUFXM0Isb0JBQWtCLGlCQVhTO0FBWTNCLHFCQUFtQixjQVpRO0FBYTNCLG9CQUFrQixxQkFiUztBQWMzQixxQkFBbUIsaUJBZFE7QUFlM0Isc0JBQW9CLFVBZk87QUFnQjNC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QUFFMEMsWUFGWjtBQUdFLElBQUEsT0FBTyxFQUFFbEMsVUFIWDtBQUlFLElBQUEsTUFBTSxFQUFFUDtBQUpWLEtBS01JLEtBTE4sRUFERjtBQVNELENBbkdEOztlQXFHZU4sYyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyB1c2VTdGF0ZSwgdXNlTWVtbyB9IGZyb20gJ3JlYWN0J1xuaW1wb3J0IFNlbGVjdCBmcm9tICdyZWFjdC1zZWxlY3QnXG5pbXBvcnQgc3BhY2V0aW1lIGZyb20gJ3NwYWNldGltZSdcbmltcG9ydCB7IGRpc3BsYXkgfSBmcm9tICdzcGFjZXRpbWUtaW5mb3JtYWwnXG5cbmV4cG9ydCBjb25zdCBpMThuVGltZXpvbmVzID0ge1xuICAnUGFjaWZpYy9NaWR3YXknOiAnTWlkd2F5IElzbGFuZCwgU2Ftb2EnLFxuICAnUGFjaWZpYy9Ib25vbHVsdSc6ICdIYXdhaWknLFxuICAnQW1lcmljYS9KdW5lYXUnOiAnQWxhc2thJyxcbiAgJ0FtZXJpY2EvQm9pc2UnOiAnTW91bnRhaW4gVGltZScsXG4gICdBbWVyaWNhL0Rhd3Nvbic6ICdEYXdzb24sIFl1a29uJyxcbiAgJ0FtZXJpY2EvQ2hpaHVhaHVhJzogJ0NoaWh1YWh1YSwgTGEgUGF6LCBNYXphdGxhbicsXG4gICdBbWVyaWNhL1Bob2VuaXgnOiAnQXJpem9uYScsXG4gICdBbWVyaWNhL0NoaWNhZ28nOiAnQ2VudHJhbCBUaW1lJyxcbiAgJ0FtZXJpY2EvUmVnaW5hJzogJ1Nhc2thdGNoZXdhbicsXG4gICdBbWVyaWNhL01leGljb19DaXR5JzogJ0d1YWRhbGFqYXJhLCBNZXhpY28gQ2l0eSwgTW9udGVycmV5JyxcbiAgJ0FtZXJpY2EvQmVsaXplJzogJ0NlbnRyYWwgQW1lcmljYScsXG4gICdBbWVyaWNhL0RldHJvaXQnOiAnRWFzdGVybiBUaW1lJyxcbiAgJ0FtZXJpY2EvQm9nb3RhJzogJ0JvZ290YSwgTGltYSwgUXVpdG8nLFxuICAnQW1lcmljYS9DYXJhY2FzJzogJ0NhcmFjYXMsIExhIFBheicsXG4gICdBbWVyaWNhL1NhbnRpYWdvJzogJ1NhbnRpYWdvJyxcbiAgJ0FtZXJpY2EvU3RfSm9obnMnOiAnTmV3Zm91bmRsYW5kIGFuZCBMYWJyYWRvcicsXG4gICdBbWVyaWNhL1Nhb19QYXVsbyc6ICdCcmFzaWxpYScsXG4gICdBbWVyaWNhL1RpanVhbmEnOiAnVGlqdWFuYSwgUGFjaWZpYyBUaW1lJyxcbiAgJ0FtZXJpY2EvQXJnZW50aW5hL0J1ZW5vc19BaXJlcyc6ICdCdWVub3MgQWlyZXMsIEdlb3JnZXRvd24nLFxuICAnQW1lcmljYS9Hb2R0aGFiJzogJ0dyZWVubGFuZCcsXG4gICdBdGxhbnRpYy9Bem9yZXMnOiAnQXpvcmVzJyxcbiAgJ0F0bGFudGljL0NhcGVfVmVyZGUnOiAnQ2FwZSBWZXJkZSBJc2xhbmRzJyxcbiAgR01UOiAnRHVibGluLCBFZGluYnVyZ2gsIExpc2JvbiwgTG9uZG9uJyxcbiAgJ0FmcmljYS9DYXNhYmxhbmNhJzogJ0Nhc2FibGFuY2EsIE1vbnJvdmlhJyxcbiAgJ0F0bGFudGljL0NhbmFyeSc6ICdDYW5hcnkgSXNsYW5kcycsXG4gICdFdXJvcGUvQmVsZ3JhZGUnOiAnQmVsZ3JhZGUsIEJyYXRpc2xhdmEsIEJ1ZGFwZXN0LCBManVibGphbmEsIFByYWd1ZScsXG4gICdFdXJvcGUvU2FyYWpldm8nOiAnU2FyYWpldm8sIFNrb3BqZSwgV2Fyc2F3LCBaYWdyZWInLFxuICAnRXVyb3BlL0JydXNzZWxzJzogJ0JydXNzZWxzLCBDb3BlbmhhZ2VuLCBNYWRyaWQsIFBhcmlzJyxcbiAgJ0V1cm9wZS9BbXN0ZXJkYW0nOiAnQW1zdGVyZGFtLCBCZXJsaW4sIEJlcm4sIFJvbWUsIFN0b2NraG9sbSwgVmllbm5hJyxcbiAgJ0FmcmljYS9BbGdpZXJzJzogJ1dlc3QgQ2VudHJhbCBBZnJpY2EnLFxuICAnRXVyb3BlL0J1Y2hhcmVzdCc6ICdCdWNoYXJlc3QnLFxuICAnQWZyaWNhL0NhaXJvJzogJ0NhaXJvJyxcbiAgJ0V1cm9wZS9IZWxzaW5raSc6ICdIZWxzaW5raSwgS2lldiwgUmlnYSwgU29maWEsIFRhbGxpbm4sIFZpbG5pdXMnLFxuICAnRXVyb3BlL0F0aGVucyc6ICdBdGhlbnMsIElzdGFuYnVsLCBNaW5zaycsXG4gICdBc2lhL0plcnVzYWxlbSc6ICdKZXJ1c2FsZW0nLFxuICAnQWZyaWNhL0hhcmFyZSc6ICdIYXJhcmUsIFByZXRvcmlhJyxcbiAgJ0V1cm9wZS9Nb3Njb3cnOiAnTW9zY293LCBTdC4gUGV0ZXJzYnVyZywgVm9sZ29ncmFkJyxcbiAgJ0FzaWEvS3V3YWl0JzogJ0t1d2FpdCwgUml5YWRoJyxcbiAgJ0FmcmljYS9OYWlyb2JpJzogJ05haXJvYmknLFxuICAnQXNpYS9CYWdoZGFkJzogJ0JhZ2hkYWQnLFxuICAnQXNpYS9UZWhyYW4nOiAnVGVocmFuJyxcbiAgJ0FzaWEvRHViYWknOiAnQWJ1IERoYWJpLCBNdXNjYXQnLFxuICAnQXNpYS9CYWt1JzogJ0Jha3UsIFRiaWxpc2ksIFllcmV2YW4nLFxuICAnQXNpYS9LYWJ1bCc6ICdLYWJ1bCcsXG4gICdBc2lhL1lla2F0ZXJpbmJ1cmcnOiAnRWthdGVyaW5idXJnJyxcbiAgJ0FzaWEvS2FyYWNoaSc6ICdJc2xhbWFiYWQsIEthcmFjaGksIFRhc2hrZW50JyxcbiAgJ0FzaWEvS29sa2F0YSc6ICdDaGVubmFpLCBLb2xrYXRhLCBNdW1iYWksIE5ldyBEZWxoaScsXG4gICdBc2lhL0thdGhtYW5kdSc6ICdLYXRobWFuZHUnLFxuICAnQXNpYS9EaGFrYSc6ICdBc3RhbmEsIERoYWthJyxcbiAgJ0FzaWEvQ29sb21ibyc6ICdTcmkgSmF5YXdhcmRlbmVwdXJhJyxcbiAgJ0FzaWEvQWxtYXR5JzogJ0FsbWF0eSwgTm92b3NpYmlyc2snLFxuICAnQXNpYS9SYW5nb29uJzogJ1lhbmdvbiBSYW5nb29uJyxcbiAgJ0FzaWEvQmFuZ2tvayc6ICdCYW5na29rLCBIYW5vaSwgSmFrYXJ0YScsXG4gICdBc2lhL0tyYXNub3lhcnNrJzogJ0tyYXNub3lhcnNrJyxcbiAgJ0FzaWEvU2hhbmdoYWknOiAnQmVpamluZywgQ2hvbmdxaW5nLCBIb25nIEtvbmcgU0FSLCBVcnVtcWknLFxuICAnQXNpYS9LdWFsYV9MdW1wdXInOiAnS3VhbGEgTHVtcHVyLCBTaW5nYXBvcmUnLFxuICAnQXNpYS9UYWlwZWknOiAnVGFpcGVpJyxcbiAgJ0F1c3RyYWxpYS9QZXJ0aCc6ICdQZXJ0aCcsXG4gICdBc2lhL0lya3V0c2snOiAnSXJrdXRzaywgVWxhYW5iYWF0YXInLFxuICAnQXNpYS9TZW91bCc6ICdTZW91bCcsXG4gICdBc2lhL1Rva3lvJzogJ09zYWthLCBTYXBwb3JvLCBUb2t5bycsXG4gICdBc2lhL1lha3V0c2snOiAnWWFrdXRzaycsXG4gICdBdXN0cmFsaWEvRGFyd2luJzogJ0RhcndpbicsXG4gICdBdXN0cmFsaWEvQWRlbGFpZGUnOiAnQWRlbGFpZGUnLFxuICAnQXVzdHJhbGlhL1N5ZG5leSc6ICdDYW5iZXJyYSwgTWVsYm91cm5lLCBTeWRuZXknLFxuICAnQXVzdHJhbGlhL0JyaXNiYW5lJzogJ0JyaXNiYW5lJyxcbiAgJ0F1c3RyYWxpYS9Ib2JhcnQnOiAnSG9iYXJ0JyxcbiAgJ0FzaWEvVmxhZGl2b3N0b2snOiAnVmxhZGl2b3N0b2snLFxuICAnUGFjaWZpYy9HdWFtJzogJ0d1YW0sIFBvcnQgTW9yZXNieScsXG4gICdBc2lhL01hZ2FkYW4nOiAnTWFnYWRhbiwgU29sb21vbiBJc2xhbmRzLCBOZXcgQ2FsZWRvbmlhJyxcbiAgJ0FzaWEvS2FtY2hhdGthJzogJ0thbWNoYXRrYSwgTWFyc2hhbGwgSXNsYW5kcycsXG4gICdQYWNpZmljL0ZpamknOiAnRmlqaSBJc2xhbmRzJyxcbiAgJ1BhY2lmaWMvQXVja2xhbmQnOiAnQXVja2xhbmQsIFdlbGxpbmd0b24nLFxuICAnUGFjaWZpYy9Ub25nYXRhcHUnOiBcIk51a3UnYWxvZmFcIixcbn1cblxuY29uc3QgVGltZXpvbmVTZWxlY3QgPSAoe1xuICB2YWx1ZSxcbiAgb25CbHVyLFxuICBvbkNoYW5nZSxcbiAgbGFiZWxTdHlsZSA9ICdvcmlnaW5hbCcsXG4gIHRpbWV6b25lcyxcbiAgLi4ucHJvcHNcbn0pID0+IHtcbiAgY29uc3QgW3NlbGVjdGVkVGltZXpvbmUsIHNldFNlbGVjdGVkVGltZXpvbmVdID0gdXNlU3RhdGUoe30pXG4gIHRpbWV6b25lcyA9IHRpbWV6b25lcyB8fCBpMThuVGltZXpvbmVzXG4gIGNvbnN0IGdldE9wdGlvbnMgPSB1c2VNZW1vKCgpID0+IHtcbiAgICBjb25zdCBvcHRpb25zID0gW11cbiAgICBPYmplY3QuZW50cmllcyh0aW1lem9uZXMpXG4gICAgICAucmVkdWNlKChvYmosIGVudHJ5KSA9PiB7XG4gICAgICAgIGNvbnN0IGEgPSBzcGFjZXRpbWUubm93KCkuZ290byhlbnRyeVswXSlcbiAgICAgICAgY29uc3QgdHogPSBhLnRpbWV6b25lKClcbiAgICAgICAgY29uc3QgdHpEaXNwbGF5ID0gZGlzcGxheShlbnRyeVswXSlcbiAgICAgICAgbGV0IGFiYnJldiA9IGVudHJ5WzBdXG4gICAgICAgIGxldCBhbHROYW1lID0gZW50cnlbMF1cbiAgICAgICAgaWYgKHR6RGlzcGxheSAmJiB0ekRpc3BsYXkuZGF5bGlnaHQgJiYgdHpEaXNwbGF5LnN0YW5kYXJkKSB7XG4gICAgICAgICAgYWJicmV2ID0gYS5pc0RTVCgpXG4gICAgICAgICAgICA/IHR6RGlzcGxheS5kYXlsaWdodC5hYmJyZXZcbiAgICAgICAgICAgIDogdHpEaXNwbGF5LnN0YW5kYXJkLmFiYnJldlxuICAgICAgICAgIGFsdE5hbWUgPSBhLmlzRFNUKClcbiAgICAgICAgICAgID8gdHpEaXNwbGF5LmRheWxpZ2h0Lm5hbWVcbiAgICAgICAgICAgIDogdHpEaXNwbGF5LnN0YW5kYXJkLm5hbWVcbiAgICAgICAgfVxuICAgICAgICBvYmoucHVzaCh7XG4gICAgICAgICAgbmFtZTogZW50cnlbMF0sXG4gICAgICAgICAgbGFiZWw6IGVudHJ5WzFdLFxuICAgICAgICAgIG9mZnNldDogdHouY3VycmVudC5vZmZzZXQsXG4gICAgICAgICAgYWJicmV2OiBhYmJyZXYsXG4gICAgICAgICAgYWx0TmFtZTogYWx0TmFtZSxcbiAgICAgICAgfSlcbiAgICAgICAgcmV0dXJuIG9ialxuICAgICAgfSlcbiAgICAgIC5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIHJldHVybiBhLm9mZnNldCAtIGIub2Zmc2V0XG4gICAgICB9KVxuICAgICAgLm1hcCh0eiA9PiB7XG4gICAgICAgIGlmICh0ei5vZmZzZXQgPT09IHVuZGVmaW5lZCkgcmV0dXJuIGZhbHNlXG4gICAgICAgIGxldCBsYWJlbCA9ICcnXG4gICAgICAgIGNvbnN0IG1pbiA9IHR6Lm9mZnNldCAqIDYwXG4gICAgICAgIGNvbnN0IGhyID1cbiAgICAgICAgICBgJHsobWluIC8gNjApIF4gMH06YCArIChtaW4gJSA2MCA9PT0gMCA/ICcwMCcgOiBNYXRoLmFicyhtaW4gJSA2MCkpXG4gICAgICAgIGNvbnN0IHByZWZpeCA9IGAoR01UJHtoci5pbmNsdWRlcygnLScpID8gaHIgOiBgKyR7aHJ9YH0pICR7dHoubGFiZWx9YFxuXG4gICAgICAgIHN3aXRjaCAobGFiZWxTdHlsZSkge1xuICAgICAgICAgIGNhc2UgJ29yaWdpbmFsJzpcbiAgICAgICAgICAgIGxhYmVsID0gcHJlZml4XG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIGNhc2UgJ2FsdE5hbWUnOlxuICAgICAgICAgICAgbGFiZWwgPSBgJHtwcmVmaXh9ICR7XG4gICAgICAgICAgICAgICF0ei5hbHROYW1lLmluY2x1ZGVzKCcvJykgPyBgKCR7dHouYWx0TmFtZX0pYCA6ICcnXG4gICAgICAgICAgICB9YFxuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICBjYXNlICdhYmJyZXYnOlxuICAgICAgICAgICAgbGFiZWwgPSBgJHtwcmVmaXh9IFxuICAgICAgICAgICAgJHt0ei5hYmJyZXYubGVuZ3RoIDwgNSA/IGAoJHt0ei5hYmJyZXZ9KWAgOiAnJ31gXG4gICAgICAgICAgICBicmVha1xuICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBsYWJlbCA9IGAke3ByZWZpeH1gXG4gICAgICAgIH1cbiAgICAgICAgb3B0aW9ucy5wdXNoKHtcbiAgICAgICAgICB2YWx1ZTogdHoubmFtZSxcbiAgICAgICAgICBsYWJlbDogbGFiZWwsXG4gICAgICAgICAgYWJicmV2OiB0ei5hYmJyZXYsXG4gICAgICAgICAgYWx0TmFtZTogdHouYWx0TmFtZSxcbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgcmV0dXJuIG9wdGlvbnNcbiAgfSwgW2xhYmVsU3R5bGVdKVxuXG4gIGNvbnN0IGhhbmRsZUNoYW5nZSA9IHR6ID0+IHtcbiAgICBzZXRTZWxlY3RlZFRpbWV6b25lKHR6KVxuICAgIG9uQ2hhbmdlICYmIG9uQ2hhbmdlKHR6KVxuICB9XG5cbiAgY29uc3QgY29uc3RydWN0VHogPSB2YWx1ZSA9PiB7XG4gICAgbGV0IHJldHVyblR6XG4gICAgaWYgKHZhbHVlLnZhbHVlICYmIHZhbHVlLmxhYmVsKSB7XG4gICAgICByZXR1cm5UeiA9IHZhbHVlXG4gICAgfSBlbHNlIGlmICh2YWx1ZS52YWx1ZSAmJiAhdmFsdWUubGFiZWwpIHtcbiAgICAgIHJldHVyblR6ID0gZ2V0T3B0aW9ucy5maW5kKHR6ID0+IHR6LnZhbHVlID09PSB2YWx1ZS52YWx1ZSlcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgJiYgIXNlbGVjdGVkVGltZXpvbmUubGFiZWwpIHtcbiAgICAgIHJldHVyblR6ID0gZ2V0T3B0aW9ucy5maW5kKHR6ID0+IHR6LnZhbHVlID09PSB2YWx1ZSlcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblR6XG4gIH1cblxuICByZXR1cm4gKFxuICAgIDxTZWxlY3RcbiAgICAgIHZhbHVlPXtjb25zdHJ1Y3RUeih2YWx1ZSl9XG4gICAgICBvbkNoYW5nZT17aGFuZGxlQ2hhbmdlfVxuICAgICAgb3B0aW9ucz17Z2V0T3B0aW9uc31cbiAgICAgIG9uQmx1cj17b25CbHVyfVxuICAgICAgey4uLnByb3BzfVxuICAgIC8+XG4gIClcbn1cblxuZXhwb3J0IGRlZmF1bHQgVGltZXpvbmVTZWxlY3RcbiJdfQ==